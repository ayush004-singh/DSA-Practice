class Solution {

    ListNode reverse(ListNode head, int times){
        ListNode curr = head;
        ListNode prev = null;
        ListNode nex = null;

        while(times != 0 && curr != null){
            nex = curr.next;
            curr.next = prev;
            prev = curr;
            curr = nex;
            times--;
        }
        return prev; // new head of reversed part
    }

    public ListNode swapPairs(ListNode head) {
        if(head == null){
            return head;
        }

        ListNode left = head;
        ListNode res = null;
        ListNode right;
        int size = 2;
        ListNode prevleft = null;

       
        while(left != null){

            right = left;
            for(int i=0;i<size-1;i++){
                if(right == null){
                    break;
                } else{
                    right = right.next;   
                }
            }

            if(right != null){ 
                ListNode nexleft = right.next;

               
                ListNode newHead = reverse(left, size);

                if(prevleft != null){
                    prevleft.next = newHead;
                }

                if(res == null){
                    res = newHead;
                }

                prevleft = left;   
                left = nexleft;
            }
            else{
                if(prevleft != null){
                    prevleft.next = left;
                }
                if(res == null){
                    res = left;
                }
                break;
            }
        }

        return res;
    }
}
